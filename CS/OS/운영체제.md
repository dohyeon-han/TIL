# 운영체제

## 운영체제의 역할
- 컴퓨터 시스템은 대게 하드웨어, 운영체제, 응용 프로그램, 사용자로 구분할 수 있다.
- 운영체제는 하드웨어와 응용 프로그램 간의 제어를 통해 사용자의 편의성을 향상(GUI, 음성인식, 터치스크린 등) 시키고 리소스를 효과적으로 할당한다.

## 인터럽트
- 운영체제는 각 장치 컨트롤러마다 장치 드라이버가 있고 컨트롤러가 작동하게 일관된 인터페이스를 제공한다. 장치 컨트롤러는 CPU의 처리를 받기 위해 서로 경쟁한다.
- 장치 컨트롤러가 작업을 완료하면 인터럽트를 통해 장치 드라이버에게 상태 정보를 반환한다.

### 인터럽트 처리 순서
- 하드웨어는 CPU에 신호를 보내 인터럽트를 발생시킨다
- CPU는 하던 일을 중단하고 현재 상태(PCB, PC)를 저장한다.
- 인터럽트의 원인을 확인하고 인터럽트 벡터를 통해 인터럽트 서비스 루틴을 호출한다.
- 인터럽트를 처리한다.
- 인터럽트에서 복귀하여 중단된 작업을 처리한다.

### 인터럽트 벡터
- 인터럽트는 굉장히 빈번하게 실행된다. 이를 빠르게 처리하기 위해 필요한 인터럽트 루틴에 대한 주소를 미리 지정하여 처리한다.

### 인터럽트가 발생하는 이유
- 키보드 입력 같은 I/O 연산은 CPU의 속도에 비해 훨씬 느리다.
- CPU를 효과적으로 사용하기 위해 인터럽트를 활용한다.

## 저장 구조
- CPU가 명령을 실행하려면 메모리에 프로그램이 적재되어야 한다. 범용 컴퓨터는 대부분의 프로그램을 메인 메모리에 적재한다. 이 메인 메모리는 주로 DRAM으로 만든다.
- RAM은 휘발성이므로 영구적으로 데이터를 보관할 수 없다. 또한 비싸기 때문에 많은 용량이 크지 않아 보조저장장치로 하드 디스크 드라이브(HDD)와 비휘발성 메모리(NVM)를 사용한다.
- DRAM과 디스크는 CPU에 비해 속도가 느리다. 이 격차를 줄이기 위해 캐시를 사용한다. 캐시는 휘발성 메모리로 자주 사용하는 데이터를 캐시에 복사해 두면 평균 메모리 접근 시간을 아낄 수 있다.

## 운영체제의 작동
### 멀티 프로그래밍과 멀티 태스킹
- 하나의 프로그램이 항상 CPU를 사용하고 있지는 않다. OS가 스케줄링을 통해 프로세스를 스케줄링하고 차례대로 CPU에 할당 받도록하여 CPU의 이용률을 높이는 것을 멀티 프로그래밍이라고 한다.
- 멀티 태스킹은 멀티 프로그래밍의 확장이다. 프로세스 간의 전환을 자주 발생시켜 CPU가 짧은 시간 동안 여러 프로세스를 번갈아가며 실행하는 것을 멀티 태스킹이라고 한다.

### 멀티 모드
- 운영체제는 잘못된 프로그램에 의해 다른 프로그램 혹은 운영체제가 잘못 실행되지 않도록 막아야 한다. 이를 위해 유저모드, 커널모드로 연산이 수행되는 위치를 나눈다.
- 트랩이나 인터럽트가 발생하면 커널모드로 전환되고 운영체제가 컴퓨터의 제어를 얻게 된다. 
- 커널모드에서만 수행되는 명령을 특권 명령이라고 하는데, 커널모드로의 전환, I/O제어, 인터럽트 관리 등이 있다.